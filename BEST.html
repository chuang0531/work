<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç’°ä¿ç”Ÿæ´»ç¢³æ’æ”¾è¿½è¹¤å™¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "å¾®è»Ÿæ­£é»‘é«”", Arial, sans-serif;
        }
        body {
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        body.loaded {
            opacity: 1;
        }
        header {
            background-color: #4CAF50;
            color: white;
            padding: 1rem;
            text-align: center;
        }
        nav {
            background-color: #388E3C;
            display: flex;
            justify-content: center;
        }
        nav a {
            color: white;
            text-decoration: none;
            padding: 1rem;
            display: inline-block;
        }
        nav a:hover {
            background-color: #2E7D32;
        }
        .container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 1rem;
            min-height: 500px;
        }
        .card {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
            margin-bottom: 2rem;
        }
        h2 {
            color: #388E3C;
            margin-bottom: 1rem;
            border-bottom: 2px solid #4CAF50;
            padding-bottom: 0.5rem;
        }
        form {
            margin-bottom: 1rem;
        }
        .form-group {
            margin-bottom: 1rem;
        }
        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: bold;
        }
        select, input {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
        }
        button {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 0.7rem 1.5rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
        }
        button:hover {
            background-color: #388E3C;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }
        table, th, td {
            border: 1px solid #ddd;
        }
        th, td {
            padding: 0.7rem;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        .plant-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 1rem;
        }
        .plant-card {
            background-color: white;
            border-radius: 8px;
            padding: 1rem;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        .plant-icon {
            font-size: 3rem;
            margin-bottom: 0.5rem;
        }
        .stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1rem;
        }
        .stat-box {
            background-color: #E8F5E9;
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
            flex: 1;
            margin: 0 0.5rem;
        }
        .stat-number {
            font-size: 1.5rem;
            font-weight: bold;
            color: #388E3C;
        }
        .daily-task {
            display: flex;
            align-items: center;
            margin-bottom: 0.5rem;
        }
        .task-checkbox {
            margin-right: 1rem;
            width: auto;
        }
        .section {
            display: none;
            opacity: 0;
            transition: opacity 0.3s ease;
            min-height: 400px;
        }
        .section.active {
            display: block;
            opacity: 1;
        }
        #exchangeSection .exchange-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #ddd;
            padding: 1rem 0;
        }
        #exchangeSection .item-details {
            flex: 1;
        }
        .article-item {
            margin-bottom: 1rem;
            cursor: pointer;
        }
        .article-item h3 {
            color: #388E3C;
            margin-bottom: 0.3rem;
        }
        .article-item h3:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <header>
        <h1>ç’°ä¿ç”Ÿæ´»ç¢³æ’æ”¾è¿½è¹¤å™¨</h1>
    </header>
    
    <nav>
        <a href="#" onclick="showSection('calculatorSection')">ç¢³æ’æ”¾è¨ˆç®—</a>
        <a href="#" onclick="showSection('recordSection')">è¨˜éŒ„æŸ¥è©¢</a>
        <a href="#" onclick="showSection('exchangeSection')">ç©åˆ†å…Œæ›</a>
        <a href="#" onclick="showSection('plantSection')">æ¤ç‰©å¯¶å…¸</a>
        <a href="#" onclick="showSection('taskSection')">æ¯æ—¥ä»»å‹™</a>
        <a href="#" onclick="showSection('readingSection')">é–±è®€å€</a>
    </nav>
    
    <div class="container">
        <div class="stats">
            <div class="stat-box">
                <div class="stat-number" id="totalCarbonStat">0</div>
                <div>ç¸½ç¢³æ’æ”¾é‡ (kg)</div>
            </div>
            <div class="stat-box">
                <div class="stat-number" id="pointsStat">0</div>
                <div>å¯ç”¨ç©åˆ†</div>
            </div>
            <div class="stat-box">
                <div class="stat-number" id="plantsCollectedStat">0</div>
                <div>å·²æ”¶é›†æ¤ç‰©</div>
            </div>
        </div>
        
        <div id="calculatorSection" class="section active card">
            <h2>ç¢³æ’æ”¾è¨ˆç®—</h2>
            <form id="calculatorForm">
                <div class="form-group">
                    <label for="actionType">é¡åˆ¥:</label>
                    <select id="actionType" required>
                        <option value="">è«‹é¸æ“‡é¡åˆ¥</option>
                        <option value="used">ä½¿ç”¨</option>
                        <option value="saved">ç¯€çœ</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="itemType">é¸æ“‡é …ç›®:</label>
                    <select id="itemType" required>
                        <option value="">è«‹é¸æ“‡é …ç›®</option>
                        <!-- ç´™è£½å“ -->
                        <option value="cup">ç´™æ¯</option>
                        <option value="paperBox">ç´™ç›’ï¼ˆåŒ…è£ç›’ï¼‰</option>
                        <option value="paperBowl">ç´™ç¢—</option>
                        <option value="paperPlate">ç´™é¤ç›¤</option>
                        <option value="paperTakeoutBox">ç´™é¤ç›’</option>
                        <option value="paperBag">ç´™è¢‹ï¼ˆè³¼ç‰©ç”¨ï¼‰</option>
                        <option value="packingPaper">åŒ…è£ç´™ï¼ˆå–®å¼µç‰›çš®ç´™ï¼‰</option>
                        <option value="cardboardBox">ç´™ç®±ï¼ˆå°å‹é‹è¼¸ç”¨ï¼‰</option>
                        <!-- å¡‘è† è£½å“ -->
                        <option value="bag">å¡‘è† è¢‹</option>
                        <option value="spoon">å¡‘è† æ¹¯åŒ™</option>
                        <option value="straw">å¡‘è† å¸ç®¡</option>
                        <option value="toothbrush">ç‰™åˆ·ï¼ˆå¡‘è† æŸ„ï¼‰</option>
                        <option value="cottonSwab">æ£‰èŠ±æ£’ï¼ˆå¡‘è† æŸ„ï¼‰</option>
                        <option value="razor">åˆ®é¬åˆ€ï¼ˆä¸€æ¬¡æ€§å¡‘è† ï¼‰</option>
                        <option value="showerCap">æµ´å¸½ï¼ˆä¸€æ¬¡æ€§å¡‘è† ï¼‰</option>
                        <option value="plasticFork">å¡‘è† å‰å­</option>
                        <option value="plasticKnife">å¡‘è† åˆ€å­</option>
                        <option value="plasticTakeoutBox">å¡‘è† ç›’ï¼ˆå¤–å¸¶ç›’ï¼‰</option>
                        <option value="plasticCup">å¡‘è† æ¯ï¼ˆä¸€æ¬¡æ€§ï¼‰</option>
                        <option value="plasticBowl">å¡‘è† ç¢—</option>
                        <option value="plasticFreshBox">ä¿é®®ç›’ï¼ˆä¸€æ¬¡æ€§ï¼‰</option>
                        <option value="plasticDrinkCupLid">é£²æ–™æ¯è“‹ï¼ˆå¡‘è† ï¼‰</option>
                        <option value="plasticFoodBox">ä¾¿ç•¶ç›’ï¼ˆä¸€æ¬¡æ€§å¡‘è† ï¼‰</option>
                        <option value="plasticSlippers">æ‹–é‹ï¼ˆä¸€æ¬¡æ€§å¡‘è† æˆ– EVAï¼‰</option>
                        <option value="plasticRaincoat">é›¨è¡£ï¼ˆä¸€æ¬¡æ€§å¡‘è† ï¼‰</option>
                        <!-- å…¶ä»– -->
                        <option value="bottle">å¯¶ç‰¹ç“¶</option>
                        <option value="toothpaste">ç‰™è†ï¼ˆå°ä»½é‡ï¼Œ10 å…‹ï¼‰</option>
                        <option value="comb">æ¢³å­ï¼ˆå¡‘è† è£½ï¼‰</option>
                        <option value="shampoo">æ´—é«®ç²¾ï¼ˆå°åŒ…è£ï¼Œ10 æ¯«å‡ï¼‰</option>
                        <option value="conditioner">æ½¤é«®ä¹³ï¼ˆå°åŒ…è£ï¼Œ10 æ¯«å‡ï¼‰</option>
                        <option value="bodyWash">æ²æµ´ä¹³ï¼ˆå°åŒ…è£ï¼Œ10 æ¯«å‡ï¼‰</option>
                        <option value="lotion">ä¹³æ¶²ï¼ˆå°åŒ…è£ï¼Œ10 æ¯«å‡ï¼‰</option>
                        <option value="toiletPaper">è¡›ç”Ÿç´™ï¼ˆæ¯æ²ï¼Œ100 å…‹ï¼‰</option>
                        <option value="mask">å£ç½©ï¼ˆä¸€æ¬¡æ€§é†«ç”¨ï¼‰</option>
                        <option value="instantNoodleBowl">æ³¡éºµç¢—ï¼ˆä¿éº—é¾ï¼‰</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="quantity">æ•¸é‡:</label>
                    <input type="number" id="quantity" min="1" max="5" value="1" required>
                </div>
                <div class="form-group">
                    <label for="date">æ—¥æœŸ:</label>
                    <input type="date" id="date" required>
                </div>
                <button type="submit">è¨ˆç®—ä¸¦è¨˜éŒ„</button>
            </form>
            <div id="resultArea">
                <h3>è¨ˆç®—çµæœ:</h3>
                <p id="carbonResult">è«‹é¸æ“‡é …ç›®ä¸¦è¼¸å…¥æ•¸é‡é€²è¡Œè¨ˆç®—ã€‚</p>
                <p id="formulaResult"></p>
            </div>
        </div>
        
        <div id="recordSection" class="section card">
            <h2>ç¢³æ’æ”¾è¨˜éŒ„</h2>
            <div class="form-group">
                <label for="recordDate">é¸æ“‡æ—¥æœŸ:</label>
                <input type="date" id="recordDate">
                <button type="button" onclick="filterRecords()">æŸ¥è©¢</button>
            </div>
            <table id="recordTable">
                <thead>
                    <tr>
                        <th>æ—¥æœŸ</th>
                        <th>é …ç›®</th>
                        <th>æ•¸é‡</th>
                        <th>ç¢³æ’æ”¾é‡ (kg)</th>
                    </tr>
                </thead>
                <tbody id="recordTableBody"></tbody>
                <tfoot>
                    <tr>
                        <td colspan="3" style="text-align: right;"><strong>ç¸½è¨ˆ:</strong></td>
                        <td id="totalCarbon">0 kg</td>
                    </tr>
                </tfoot>
            </table>
        </div>
        
        <div id="exchangeSection" class="section card">
            <h2>ç©åˆ†å…Œæ›</h2>
            <p>æ‚¨ç›®å‰æ“æœ‰ <span id="currentPoints">0</span> ç©åˆ†</p>
            <div class="exchange-item">
                <div>ğŸŒ±</div>
                <div class="item-details">
                    <h3>è˜‹æœæ¨¹</h3>
                    <p>æ¯å¹´å¯å¸æ”¶ç´„20kgäºŒæ°§åŒ–ç¢³</p>
                </div>
                <div>
                    <span>30 ç©åˆ†</span>
                    <button onclick="exchangePlant('apple-tree', 30, 'ğŸ')">å…Œæ›</button>
                </div>
            </div>
            <div class="exchange-item">
                <div>ğŸŒ±</div>
                <div class="item-details">
                    <h3>æ©¡æ¨¹</h3>
                    <p>æ¯å¹´å¯å¸æ”¶ç´„40kgäºŒæ°§åŒ–ç¢³</p>
                </div>
                <div>
                    <span>50 ç©åˆ†</span>
                    <button onclick="exchangePlant('oak-tree', 50, 'ğŸŒ³')">å…Œæ›</button>
                </div>
            </div>
            <div class="exchange-item">
                <div>ğŸŒ±</div>
                <div class="item-details">
                    <h3>å‘æ—¥è‘µ</h3>
                    <p>ç¾éº—çš„èŠ±æœµèƒ½æ·¨åŒ–ç©ºæ°£</p>
                </div>
                <div>
                    <span>10 ç©åˆ†</span>
                    <button onclick="exchangePlant('sunflower', 10, 'ğŸŒ»')">å…Œæ›</button>
                </div>
            </div>
            <div class="exchange-item">
                <div>ğŸŒ±</div>
                <div class="item-details">
                    <h3>æ¾æ¨¹</h3>
                    <p>æ¯å¹´å¯å¸æ”¶ç´„30kgäºŒæ°§åŒ–ç¢³</p>
                </div>
                <div>
                    <span>40 ç©åˆ†</span>
                    <button onclick="exchangePlant('pine-tree', 40, 'ğŸŒ²')">å…Œæ›</button>
                </div>
            </div>
            <div class="exchange-item">
                <div>ğŸŒ±</div>
                <div class="item-details">
                    <h3>ç«¹å­</h3>
                    <p>ç”Ÿé•·å¿«é€Ÿï¼Œå¸æ”¶äºŒæ°§åŒ–ç¢³èƒ½åŠ›å¼·</p>
                </div>
                <div>
                    <span>20 ç©åˆ†</span>
                    <button onclick="exchangePlant('bamboo', 20, 'ğŸ‹')">å…Œæ›</button>
                </div>
            </div>
        </div>
        
        <div id="plantSection" class="section card">
            <h2>æ¤ç‰©å¯¶å…¸</h2>
            <p>å·²æ”¶é›†: <span id="plantCount">0</span>/5</p>
            <div class="plant-grid" id="plantGrid"></div>
        </div>
        
        <div id="taskSection" class="section card">
            <h2>æ¯æ—¥ä»»å‹™</h2>
            <p>å®Œæˆä»»å‹™ç²å¾—é¡å¤–ç©åˆ†ï¼</p>
            <div class="daily-task">
                <input type="checkbox" id="task1" class="task-checkbox" onchange="updateTaskProgress()">
                <label for="task1">è¼¸å…¥ä¸‰ç­†è³‡æ–™ (0/3)</label>
            </div>
            <div class="daily-task">
                <input type="checkbox" id="task2" class="task-checkbox" onchange="updateTaskProgress()">
                <label for="task2">æ¸›å°‘ä½¿ç”¨5å€‹ç´™æ¯ (0/5)</label>
            </div>
            <div class="daily-task">
                <input type="checkbox" id="task3" class="task-checkbox" onchange="updateTaskProgress()">
                <label for="task3">ä¸€å¤©ä¸ä½¿ç”¨å¡‘è† è¢‹</label>
            </div>
            <div>
                <p>ä»Šæ—¥ä»»å‹™å®Œæˆ: <span id="taskProgress">0</span>/3</p>
                <button id="claimTaskReward" disabled onclick="claimTaskReward()">é ˜å–çå‹µ (1 ç©åˆ†)</button>
            </div>
        </div>
        
        <div id="readingSection" class="section card">
            <h2>é–±è®€å€ - ç¢³æ’æ”¾èˆ‡ç’°å¢ƒ</h2>
            <p>é»æ“Šæ–‡ç« æ¨™é¡Œå‰å¾€å¤–éƒ¨ç¶²ç«™é–±è®€å…§å®¹ï¼Œæ¯ç¯‡é¦–æ¬¡é–±è®€å¯ç²å¾— 5 ç©åˆ†ï¼</p>
            <div id="articleList">
                <div class="article-item">
                    <h3 onclick="readArticle('article1', 'https://www.climate.gov/news-features/understanding-climate/climate-change-atmospheric-carbon-dioxide')">1. ç¢³æ’æ”¾å¦‚ä½•å½±éŸ¿å…¨çƒæ°£æº«</h3>
                    <p>ç°¡ä»‹ï¼šæ¢è¨ç¢³æ’æ”¾èˆ‡æ°£å€™è®Šæš–çš„é—œè¯ï¼ˆä¾†æºï¼šNOAA Climate.govï¼‰ã€‚</p>
                </div>
                <div class="article-item">
                    <h3 onclick="readArticle('article2', 'https://www.nature.com/articles/s41586-019-1526-0')">2. æµ·æ´‹é…¸åŒ–èˆ‡ç¢³æ’æ”¾</h3>
                    <p>ç°¡ä»‹ï¼šæµ·æ´‹å¸æ”¶äºŒæ°§åŒ–ç¢³çš„å¾Œæœï¼ˆä¾†æºï¼šNatureï¼‰ã€‚</p>
                </div>
                <div class="article-item">
                    <h3 onclick="readArticle('article3', 'https://www.carbonbrief.org/explainer-how-deforestation-and-climate-change-are-linked')">3. æ£®æ—æ¸›å°‘èˆ‡ç¢³æ’æ”¾</h3>
                    <p>ç°¡ä»‹ï¼šç ä¼æ£®æ—å¦‚ä½•åŠ åŠ‡ç¢³æ’æ”¾ï¼ˆä¾†æºï¼šCarbon Briefï¼‰ã€‚</p>
                </div>
                <div class="article-item">
                    <h3 onclick="readArticle('article4', 'https://ourworldindata.org/extreme-weather')">4. ç¢³æ’æ”¾èˆ‡æ¥µç«¯å¤©æ°£</h3>
                    <p>ç°¡ä»‹ï¼šæ°£å€™è®ŠåŒ–å¦‚ä½•å¼•ç™¼å¤©ç½ï¼ˆä¾†æºï¼šOur World in Dataï¼‰ã€‚</p>
                </div>
                <div class="article-item">
                    <h3 onclick="readArticle('article5', 'https://climate.nasa.gov/news/2915/the-atmosphere-getting-a-handle-on-carbon-dioxide')">5. å¥åº·å¨è„…èˆ‡ç¢³æ’æ”¾</h3>
                    <p>ç°¡ä»‹ï¼šç©ºæ°£æ±¡æŸ“èˆ‡ç¢³æ’æ”¾çš„é—œè¯ï¼ˆä¾†æºï¼šNASA Climateï¼‰ã€‚</p>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('date').value = today;
            document.getElementById('recordDate').value = today;
            
            const sections = document.querySelectorAll('.section');
            sections.forEach(section => section.style.visibility = 'hidden');
            
            loadFromLocalStorage();
            updateStats();
            updatePlantCollection();
            filterRecords();
            
            sections.forEach(section => section.style.visibility = 'visible');
            document.body.classList.add('loaded');
        });
        
        const carbonData = {
            'cup': 0.01, 'bag': 0.006, 'spoon': 0.005, 'bottle': 0.08, 'straw': 0.0005,
            'shampoo': 0.015, 'conditioner': 0.015, 'bodyWash': 0.015, 'lotion': 0.015,
            'showerCap': 0.02, 'toiletPaper': 0.225, 'cottonSwab': 0.0015, 'mask': 0.035,
            'plasticFork': 0.03, 'plasticKnife': 0.03, 'instantNoodleBowl': 0.075, 'paperBox': 0.035,
            'paperBowl': 0.03, 'paperPlate': 0.035, 'paperTakeoutBox': 0.045, 'plasticTakeoutBox': 0.075,
            'plasticCup': 0.045, 'plasticBowl': 0.06, 'toothpaste': 0.03, 'plasticFreshBox': 0.075,
            'plasticDrinkCupLid': 0.02, 'plasticFoodBox': 0.115, 'plasticSlippers': 0.075, 
            'plasticRaincoat': 0.075, 'plasticFoodWrap': 0.075, 'paperBag': 0.055, 'packingPaper': 0.01, 
            'cardboardBox': 0.35, 'toothbrush': 0.045, 'razor': 0.045, 'comb': 0.03
        };
        const itemNames = {
            'cup': 'ç´™æ¯', 'bag': 'å¡‘è† è¢‹', 'spoon': 'å¡‘è† æ¹¯åŒ™', 'bottle': 'å¯¶ç‰¹ç“¶', 'straw': 'å¡‘è† å¸ç®¡',
            'shampoo': 'æ´—é«®ç²¾ï¼ˆå°åŒ…è£ï¼Œ10 æ¯«å‡ï¼‰', 'conditioner': 'æ½¤é«®ä¹³ï¼ˆå°åŒ…è£ï¼Œ10 æ¯«å‡ï¼‰', 'bodyWash': 'æ²æµ´ä¹³ï¼ˆå°åŒ…è£ï¼Œ10 æ¯«å‡ï¼‰', 'lotion': 'ä¹³æ¶²ï¼ˆå°åŒ…è£ï¼Œ10 æ¯«å‡ï¼‰',
            'showerCap': 'æµ´å¸½ï¼ˆä¸€æ¬¡æ€§å¡‘è† ï¼‰', 'toiletPaper': 'è¡›ç”Ÿç´™ï¼ˆæ¯æ²ï¼Œ100 å…‹ï¼‰', 'cottonSwab': 'æ£‰èŠ±æ£’ï¼ˆå¡‘è† æŸ„ï¼‰', 'mask': 'å£ç½©ï¼ˆä¸€æ¬¡æ€§é†«ç”¨ï¼‰',
            'plasticFork': 'å¡‘è† å‰å­', 'plasticKnife': 'å¡‘è† åˆ€å­', 'instantNoodleBowl': 'æ³¡éºµç¢—ï¼ˆä¿éº—é¾ï¼‰', 'paperBox': 'ç´™ç›’ï¼ˆåŒ…è£ç›’ï¼‰',
            'paperBowl': 'ç´™ç¢—', 'paperPlate': 'ç´™é¤ç›¤', 'paperTakeoutBox': 'ç´™é¤ç›’', 'plasticTakeoutBox': 'å¡‘è† ç›’ï¼ˆå¤–å¸¶ç›’ï¼‰',
            'plasticCup': 'å¡‘è† æ¯ï¼ˆä¸€æ¬¡æ€§ï¼‰', 'plasticBowl': 'å¡‘è† ç¢—', 'toothpaste': 'ç‰™è†ï¼ˆå°ä»½é‡ï¼Œ10 å…‹ï¼‰',
            'plasticFreshBox': 'ä¿é®®ç›’ï¼ˆä¸€æ¬¡æ€§ï¼‰', 'plasticDrinkCupLid': 'é£²æ–™æ¯è“‹ï¼ˆå¡‘è† ï¼‰', 'plasticFoodBox': 'ä¾¿ç•¶ç›’ï¼ˆä¸€æ¬¡æ€§å¡‘è† ï¼‰',
            'plasticSlippers': 'æ‹–é‹ï¼ˆä¸€æ¬¡æ€§å¡‘è† æˆ– EVAï¼‰', 'plasticRaincoat': 'é›¨è¡£ï¼ˆä¸€æ¬¡æ€§å¡‘è† ï¼‰', 'plasticFoodWrap': 'é£Ÿç‰©åŒ…è£è†œï¼ˆé‹ç®”ï¼Œ1 å¹³æ–¹ç±³ï¼‰',
            'paperBag': 'ç´™è¢‹ï¼ˆè³¼ç‰©ç”¨ï¼‰', 'packingPaper': 'åŒ…è£ç´™ï¼ˆå–®å¼µç‰›çš®ç´™ï¼‰', 'cardboardBox': 'ç´™ç®±ï¼ˆå°å‹é‹è¼¸ç”¨ï¼‰',
            'toothbrush': 'ç‰™åˆ·ï¼ˆå¡‘è† æŸ„ï¼‰', 'razor': 'åˆ®é¬åˆ€ï¼ˆä¸€æ¬¡æ€§å¡‘è† ï¼‰', 'comb': 'æ¢³å­ï¼ˆå¡‘è† è£½ï¼‰'
        };

        const plants = {
            'apple-tree': { name: 'è˜‹æœæ¨¹', icon: 'ğŸ', description: 'æ¯å¹´å¯å¸æ”¶ç´„20kgäºŒæ°§åŒ–ç¢³' },
            'oak-tree': { name: 'æ©¡æ¨¹', icon: 'ğŸŒ³', description: 'æ¯å¹´å¯å¸æ”¶ç´„40kgäºŒæ°§åŒ–ç¢³' },
            'sunflower': { name: 'å‘æ—¥è‘µ', icon: 'ğŸŒ»', description: 'ç¾éº—çš„èŠ±æœµèƒ½æ·¨åŒ–ç©ºæ°£' },
            'pine-tree': { name: 'æ¾æ¨¹', icon: 'ğŸŒ²', description: 'æ¯å¹´å¯å¸æ”¶ç´„30kgäºŒæ°§åŒ–ç¢³' },
            'bamboo': { name: 'ç«¹å­', icon: 'ğŸ‹', description: 'ç”Ÿé•·å¿«é€Ÿï¼Œå¸æ”¶äºŒæ°§åŒ–ç¢³èƒ½åŠ›å¼·' }
        };
        
        let userData = {
            records: [],
            totalCarbon: 0,
            points: 0,
            plants: {},
            dailyEntries: 0,
            taskRewardClaimed: false,
            lastTaskDate: '',
            readArticles: []
        };
        
        document.getElementById('calculatorForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const actionType = document.getElementById('actionType').value;
            const itemType = document.getElementById('itemType').value;
            const quantity = parseInt(document.getElementById('quantity').value);
            const date = document.getElementById('date').value;
            
            if (!actionType || !itemType || !quantity || !date) {
                alert('è«‹å¡«å¯«æ‰€æœ‰æ¬„ä½');
                return;
            }
            
            if (quantity > 5) {
                alert('å–®ç­†æ•¸é‡æœ€å¤šç‚º 5 å€‹');
                return;
            }
            
            const todayRecords = userData.records.filter(record => record.date === date).length;
            if (todayRecords >= 15) {
                alert('å–®æ—¥åƒ…æä¾›è¨ˆç®— 15 ç­†ï¼Œå·²é”ä¸Šé™');
                return;
            }
            
            const carbonEmission = calculateCarbon(actionType, itemType, quantity);
            
            const actionText = actionType === 'used' ? 'ä½¿ç”¨' : 'ç¯€çœ';
            const sign = actionType === 'used' ? '-' : '+';
            document.getElementById('carbonResult').textContent = 
                `${actionText} ${quantity} å€‹${itemNames[itemType]}ï¼Œç¢³æ’æ”¾å½±éŸ¿ï¼š${carbonEmission.toFixed(3)} kg`;
            document.getElementById('formulaResult').textContent = 
                `è¨ˆç®—å…¬å¼ï¼š${sign}${carbonData[itemType].toFixed(4)} kg Ã— ${quantity} = ${carbonEmission.toFixed(3)} kg`;
            
            saveRecord(date, itemType, quantity, carbonEmission, actionType);
            updateStats();
            checkDailyTaskProgress();
        });
        
        function calculateCarbon(actionType, itemType, quantity) {
            const baseCarbon = carbonData[itemType] * quantity;
            return actionType === 'used' ? -baseCarbon : baseCarbon;
        }
        
        function saveRecord(date, itemType, quantity, carbonEmission, actionType) {
            const record = {
                date: date,
                itemType: itemType,
                itemName: itemNames[itemType],
                quantity: quantity,
                carbon: carbonEmission,
                actionType: actionType
            };
            
            userData.records.push(record);
            userData.totalCarbon += carbonEmission;
            
            const today = new Date().toISOString().split('T')[0];
            const todayCarbon = userData.records
                .filter(record => record.date === today)
                .reduce((sum, record) => sum + record.carbon, 0);
            const todayPoints = Math.floor(Math.max(todayCarbon, 0));
            userData.points += todayPoints >= 0 ? todayPoints : 0;
            
            if (date === today) {
                userData.dailyEntries++;
            }
            
            saveToLocalStorage();
            filterRecords();
        }
        
        function filterRecords() {
            const dateFilter = document.getElementById('recordDate').value;
            const tbody = document.getElementById('recordTableBody');
            tbody.innerHTML = '';
            
            let totalFilteredCarbon = 0;
            
            userData.records.forEach(record => {
                if (!dateFilter || record.date === dateFilter) {
                    const row = document.createElement('tr');
                    
                    const dateCell = document.createElement('td');
                    dateCell.textContent = record.date;
                    row.appendChild(dateCell);
                    
                    const itemCell = document.createElement('td');
                    itemCell.textContent = `${record.actionType === 'used' ? 'ä½¿ç”¨' : 'ç¯€çœ'} ${record.itemName}`;
                    row.appendChild(itemCell);
                    
                    const quantityCell = document.createElement('td');
                    quantityCell.textContent = record.quantity;
                    row.appendChild(quantityCell);
                    
                    const carbonCell = document.createElement('td');
                    carbonCell.textContent = record.carbon.toFixed(3) + ' kg';
                    carbonCell.style.color = record.carbon >= 0 ? 'green' : 'red';
                    row.appendChild(carbonCell);
                    
                    tbody.appendChild(row);
                    
                    totalFilteredCarbon += record.carbon;
                }
            });
            
            document.getElementById('totalCarbon').textContent = totalFilteredCarbon.toFixed(3) + ' kg';
        }
        
        function exchangePlant(plantId, cost, icon) {
            if (userData.points < cost) {
                alert('ç©åˆ†ä¸è¶³ï¼');
                return;
            }
            
            userData.points -= cost;
            
            if (!userData.plants[plantId]) {
                userData.plants[plantId] = {
                    id: plantId,
                    count: 1,
                    name: plants[plantId].name,
                    icon: plants[plantId].icon,
                    description: plants[plantId].description
                };
            } else {
                userData.plants[plantId].count++;
            }
            
            saveToLocalStorage();
            updateStats();
            updatePlantCollection();
            
            alert(`æˆåŠŸå…Œæ› ${plants[plantId].name}ï¼`);
        }
        
        function updatePlantCollection() {
            const grid = document.getElementById('plantGrid');
            grid.innerHTML = '';
            
            for (const plantId in userData.plants) {
                const plant = userData.plants[plantId];
                const card = document.createElement('div');
                card.className = 'plant-card';
                
                const icon = document.createElement('div');
                icon.className = 'plant-icon';
                icon.textContent = plant.icon;
                
                const name = document.createElement('h3');
                name.textContent = plant.name;
                
                const count = document.createElement('p');
                count.textContent = `æ•¸é‡: ${plant.count}`;
                
                const desc = document.createElement('p');
                desc.textContent = plant.description;
                
                card.appendChild(icon);
                card.appendChild(name);
                card.appendChild(count);
                card.appendChild(desc);
                grid.appendChild(card);
            }
            
            for (const plantId in plants) {
                if (!userData.plants[plantId]) {
                    const card = document.createElement('div');
                    card.className = 'plant-card';
                    card.style.opacity = '0.5';
                    
                    const icon = document.createElement('div');
                    icon.className = 'plant-icon';
                    icon.textContent = 'â“';
                    
                    const name = document.createElement('h3');
                    name.textContent = 'æœªæ”¶é›†';
                    
                    card.appendChild(icon);
                    card.appendChild(name);
                    grid.appendChild(card);
                }
            }
            
            const collectedCount = Object.keys(userData.plants).length;
            document.getElementById('plantCount').textContent = collectedCount;
        }
        
        function checkDailyTaskProgress() {
            const today = new Date().toISOString().split('T')[0];
            
            if (userData.lastTaskDate !== today) {
                userData.lastTaskDate = today;
                userData.dailyEntries = countTodayEntries();
                userData.taskRewardClaimed = false;
                document.getElementById('task1').checked = false;
                document.getElementById('task2').checked = false;
                document.getElementById('task3').checked = false;
                document.getElementById('claimTaskReward').disabled = true;
            }
            
            const task1 = document.getElementById('task1');
            const entriesCount = countTodayEntries();
            task1.nextElementSibling.textContent = `è¼¸å…¥ä¸‰ç­†è³‡æ–™ (${Math.min(entriesCount, 3)}/3)`;
            task1.checked = entriesCount >= 3;
            
            const task2 = document.getElementById('task2');
            const cupsSavedToday = countTodayItemUsage('cup');
            task2.nextElementSibling.textContent = `æ¸›å°‘ä½¿ç”¨5å€‹ç´™æ¯ (${Math.min(cupsSavedToday, 5)}/5)`;
            task2.checked = cupsSavedToday >= 5;
            
            updateTaskProgress();
            saveToLocalStorage();
        }
        
        function countTodayEntries() {
            const today = new Date().toISOString().split('T')[0];
            return userData.records.filter(record => record.date === today).length;
        }
        
        function countTodayItemUsage(itemType) {
            const today = new Date().toISOString().split('T')[0];
            return userData.records
                .filter(record => record.date === today && record.itemType === itemType)
                .reduce((total, record) => total + record.quantity, 0);
        }
        
        function updateTaskProgress() {
            const task1 = document.getElementById('task1').checked;
            const task2 = document.getElementById('task2').checked;
            const task3 = document.getElementById('task3').checked;
            
            const completedTasks = [task1, task2, task3].filter(Boolean).length;
            document.getElementById('taskProgress').textContent = completedTasks;
            
            const rewardButton = document.getElementById('claimTaskReward');
            rewardButton.disabled = completedTasks < 3 || userData.taskRewardClaimed;
        }
        
        function claimTaskReward() {
            if (userData.taskRewardClaimed) {
                alert('æ‚¨ä»Šå¤©å·²ç¶“é ˜å–éçå‹µäº†ï¼');
                return;
            }
            
            userData.points += 1;
            userData.taskRewardClaimed = true;
            saveToLocalStorage();
            updateStats();
            document.getElementById('claimTaskReward').disabled = true;
            alert('æ­å–œæ‚¨ç²å¾—1é»ç©åˆ†ï¼');
        }
        
        function updateStats() {
            document.getElementById('totalCarbonStat').textContent = userData.totalCarbon.toFixed(1);
            document.getElementById('pointsStat').textContent = userData.points;
            document.getElementById('currentPoints').textContent = userData.points;
            const plantsCollected = Object.keys(userData.plants).length;
            document.getElementById('plantsCollectedStat').textContent = plantsCollected;
        }
        
        function showSection(sectionId) {
            const sections = document.querySelectorAll('.section');
            sections.forEach(section => section.classList.remove('active'));
            
            const targetSection = document.getElementById(sectionId);
            targetSection.classList.add('active');
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        function readArticle(articleId, url) {
            console.log(`å˜—è©¦é–±è®€æ–‡ç« : ${articleId}, URL: ${url}`);

            // æª¢æŸ¥æ˜¯å¦é¦–æ¬¡é–±è®€ï¼Œè‹¥æ˜¯å‰‡å¢åŠ ç©åˆ†
            if (!userData.readArticles.includes(articleId)) {
                userData.points += 5;
                userData.readArticles.push(articleId);
                saveToLocalStorage();
                updateStats();
                alert(`é–±è®€æˆåŠŸï¼ç²å¾— 5 ç©åˆ†ï¼Œç›®å‰ç¸½ç©åˆ†ï¼š${userData.points}`);
            }

            // ç›´æ¥è·³è½‰åˆ°å¤–éƒ¨é€£çµï¼Œé¿å…å½ˆçª—æ””æˆªå•é¡Œ
            const confirmed = confirm('å³å°‡å‰å¾€å¤–éƒ¨ç¶²ç«™é–±è®€æ–‡ç« ï¼Œæ˜¯å¦ç¹¼çºŒï¼Ÿ');
            if (confirmed) {
                console.log(`æ­£åœ¨é–‹å•Ÿ URL: ${url}`);
                const newWindow = window.open(url, '_blank');
                if (!newWindow) {
                    alert('ç„¡æ³•é–‹å•Ÿé€£çµï¼Œè«‹æª¢æŸ¥ç€è¦½å™¨è¨­å®šæˆ–ç¶²è·¯é€£ç·šï¼');
                }
            } else {
                console.log('ä½¿ç”¨è€…å–æ¶ˆè·³è½‰');
            }
        }
        
        function saveToLocalStorage() {
            localStorage.setItem('ecoTrackerData', JSON.stringify(userData));
        }
        
        function loadFromLocalStorage() {
            const savedData = localStorage.getItem('ecoTrackerData');
            if (savedData) {
                userData = JSON.parse(savedData);
            }
        }
    </script>
</body>
</html>
